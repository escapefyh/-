<!--pages/firelist/firelist.wxml-->
<view class="container">
  <!-- é¡¶éƒ¨æ°›å›´è¥é€ åŒº -->
  <view class="header-section">
    <view class="header-content">
      <!-- å·¦ä¾§ï¼šæ ‡é¢˜åŒºåŸŸ -->
      <view class="header-left">
        <view class="main-title">ğŸ”¥ çƒ­åº¦æ¦œ</view>
        <view class="sub-title">å®æ—¶æ›´æ–° â€¢ æ‰‹æ…¢æ— </view>
      </view>
      
      <!-- å³ä¾§ï¼šå€’è®¡æ—¶ -->
      <view class="header-right">
        <view class="countdown-label">è·æœ¬åœºæ›´æ–°</view>
        <view class="countdown-box">
          <view class="countdown-item">{{countdown.hours}}</view>
          <text class="countdown-separator">:</text>
          <view class="countdown-item">{{countdown.minutes}}</view>
          <text class="countdown-separator">:</text>
          <view class="countdown-item">{{countdown.seconds}}</view>
        </view>
      </view>
    </view>
  </view>

  <!-- åˆ—è¡¨å®¹å™¨ï¼ˆå‘ä¸Šè¦†ç›–Headerï¼‰ -->
  <view class="list-container">
    <!-- åŠ è½½ä¸­çŠ¶æ€ -->
    <view wx:if="{{loading && goodsList.length === 0}}" class="loading-container">
      <text>åŠ è½½ä¸­...</text>
    </view>

    <!-- ç©ºçŠ¶æ€ -->
    <view wx:elif="{{!loading && goodsList.length === 0}}" class="empty-container">
      <text>æš‚æ— çƒ­åº¦å•†å“</text>
    </view>

    <!-- å•†å“åˆ—è¡¨ -->
    <view wx:else class="goods-list">
      <view 
        class="goods-card {{item.rank <= 3 ? 'top-three' : ''}}"
        wx:for="{{goodsList}}" 
        wx:key="goods_id"
        bindtap="onGoodsClick"
        data-goods-id="{{item.goods_id}}"
      >
        <!-- å·¦ä¾§ï¼šå›¾ç‰‡åŒºï¼ˆ35%å®½åº¦ï¼‰ -->
        <view class="goods-image-wrapper">
          <image 
            wx:if="{{item.images && item.images.length > 0 && item.images[0]}}"
            class="goods-image" 
            src="{{item.images[0]}}" 
            mode="aspectFill"
            lazy-load="{{true}}"
            binderror="onImageError"
            data-index="{{index}}"
            data-goods-id="{{item.goods_id}}"
          />
          <image 
            wx:else
            class="goods-image" 
            src="/assets/store.png" 
            mode="aspectFill"
          />
          
          <!-- æ’åè§’æ ‡ï¼ˆå·¦ä¸Šè§’ï¼‰ -->
          <view class="rank-badge rank-{{item.rank <= 3 ? item.rank : 'other'}}">
            <text class="rank-text">{{item.rank}}</text>
          </view>
          
          <!-- å­¤å“è§’æ ‡ï¼ˆåº•éƒ¨ï¼‰ -->
          <view wx:if="{{item.isOnlyOne}}" class="stock-tag">
            <text>ä»… 1 ä»¶</text>
          </view>
        </view>

        <!-- å³ä¾§ï¼šä¿¡æ¯åŒºï¼ˆ65%å®½åº¦ï¼‰ -->
        <view class="goods-info-wrapper">
          <!-- ç¬¬ä¸€è¡Œï¼šæ ‡é¢˜ -->
          <view class="goods-title">{{item.description}}</view>
          
          <!-- ç¬¬äºŒè¡Œï¼šçƒ­åº¦è¿›åº¦æ¡ -->
          <view class="heat-section">
            <view class="heat-bar-wrapper">
              <view class="heat-bar-bg">
                <view class="heat-bar-fill" style="width: {{item.heatProgress}}%"></view>
              </view>
              <text class="heat-text">ğŸ”¥ çƒ­åº¦ {{item.heatScore}}</text>
            </view>
          </view>
          
          <!-- ç¬¬ä¸‰è¡Œï¼šä»·æ ¼ä¸æŒ‰é’® -->
          <view class="action-section">
            <!-- ä»·æ ¼ï¼ˆå·¦ä¸‹è§’ï¼‰ -->
            <view class="price-wrapper">
              <text class="price-symbol">Â¥</text>
              <text class="price-number">{{item.price}}</text>
            </view>
            
            <!-- æŒ‰é’®ï¼ˆå³ä¸‹è§’ï¼‰ -->
            <view 
              class="action-button {{item.rank <= 3 ? 'pulse' : ''}}"
              bindtap="onButtonClick"
              data-goods-id="{{item.goods_id}}"
              catchtap="true"
            >
              <text>{{item.rank <= 3 ? 'é©¬ä¸ŠæŠ¢' : 'å»çœ‹çœ‹'}}</text>
            </view>
          </view>
        </view>
      </view>
    </view>

    <!-- åŠ è½½æ›´å¤šæç¤º -->
    <view wx:if="{{loading && goodsList.length > 0}}" class="loading-more">
      <text>åŠ è½½ä¸­...</text>
    </view>
    <view wx:if="{{!hasMore && goodsList.length > 0}}" class="no-more">
      <text>æ²¡æœ‰æ›´å¤šäº†</text>
    </view>
  </view>
</view>
