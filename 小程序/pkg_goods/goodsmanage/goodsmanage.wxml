<!--pages/goodsmanage/goodsmanage.wxml-->
<view class="goodsmanage-page">
  <!-- 加载中状态 -->
  <view wx:if="{{loading && goodsList.length === 0}}" class="loading-container">
    <text>加载中...</text>
  </view>

  <!-- 空状态 -->
  <view wx:elif="{{!loading && goodsList.length === 0}}" class="empty-container">
    <text>暂无商品</text>
    <view class="empty-tip">快去发布你的第一个商品吧~</view>
  </view>

  <!-- 商品列表 -->
  <view wx:else class="goods-list">
    <view 
      class="goods-item" 
      wx:for="{{goodsList}}" 
      wx:key="goods_id"
    >
      <!-- 商品图片 -->
      <view class="goods-image-wrapper">
          <image 
            wx:if="{{item.images && item.images.length > 0}}"
            class="goods-image" 
            src="{{item.images[0]}}" 
            mode="aspectFill"
            binderror="onImageError"
            data-index="{{index}}"
            lazy-load="{{true}}"
          />
        <image 
          wx:else
          class="goods-image" 
          src="/assets/default_goods.png" 
          mode="aspectFill"
        />
      </view>

      <!-- 商品信息 -->
      <view class="goods-info">
        <view class="goods-description">{{item.description}}</view>
        <view class="goods-price">¥{{item.price}}</view>
      </view>

      <!-- 操作按钮 -->
      <view class="goods-actions">
        <view class="action-btn edit-btn" bind:tap="onEdit" data-goods-id="{{item.goods_id}}">
          <text>编辑</text>
        </view>
        <view class="action-btn delete-btn" bind:tap="onDelete" data-goods-id="{{item.goods_id}}">
          <text>删除</text>
        </view>
      </view>
    </view>
  </view>

  <!-- 加载更多提示 -->
  <view wx:if="{{loading && goodsList.length > 0}}" class="loading-more">
    <text>加载中...</text>
  </view>
  <view wx:if="{{!hasMore && goodsList.length > 0}}" class="no-more">
    <text>没有更多了</text>
  </view>

  <!-- 编辑价格弹窗 -->
  <view wx:if="{{showEditModal}}" class="edit-modal" catchtap="onCloseEditModal">
    <view class="edit-modal-content" catchtap="stopPropagation">
      <view class="edit-modal-header">
        <text class="edit-modal-title">编辑商品价格</text>
        <view class="edit-modal-close" catchtap="onCloseEditModal">×</view>
      </view>
      <view class="edit-modal-body">
        <view class="edit-form-item">
          <text class="edit-label">商品描述：</text>
          <text class="edit-value">{{editingGoods.description}}</text>
        </view>
        <view class="edit-form-item">
          <text class="edit-label">当前价格：</text>
          <text class="edit-value">¥{{editingGoods.price}}</text>
        </view>
        <view class="edit-form-item">
          <text class="edit-label">新价格：</text>
          <input 
            class="edit-input" 
            type="digit" 
            placeholder="请输入新价格"
            value="{{newPrice}}"
            bindinput="onPriceInput"
          />
        </view>
      </view>
      <view class="edit-modal-footer">
        <view class="edit-btn-cancel" catchtap="onCloseEditModal">取消</view>
        <view class="edit-btn-confirm" catchtap="onConfirmEdit">确认</view>
      </view>
    </view>
  </view>
</view>

















