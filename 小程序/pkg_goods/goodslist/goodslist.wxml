<!--pages/goodslist/goodslist.wxml-->
<view class="goods-list-page">
  <!-- æœç´¢æ¡† -->
  <view class="search-section">
    <view class="search-container">
      <view class="search-input-wrapper">
        <text class="search-icon">ğŸ”</text>
        <input
          class="search-input"
          type="text"
          value="{{searchKeyword}}"
          placeholder="æœç´¢{{categoryName || 'å•†å“'}}"
          confirm-type="search"
          bindinput="onSearchInput"
          bindconfirm="onSearch"
        />
        <view 
          wx:if="{{searchKeyword}}"
          class="search-clear"
          catchtap="onSearchClear"
        >
          <text>Ã—</text>
        </view>
      </view>
      <view class="search-button" catchtap="onSearchButtonClick">
        <text>æœç´¢</text>
      </view>
    </view>
  </view>

  <!-- åŠ è½½ä¸­çŠ¶æ€ -->
  <view wx:if="{{loading && goodsList.length === 0}}" class="loading-container">
    <text>åŠ è½½ä¸­...</text>
  </view>

  <!-- ç©ºçŠ¶æ€ -->
  <view wx:elif="{{!loading && goodsList.length === 0}}" class="empty-container">
    <text>æš‚æ— å•†å“</text>
  </view>

  <!-- å•†å“ç½‘æ ¼ -->
  <view wx:else class="goods-grid">
    <view 
      class="goods-item" 
      wx:for="{{goodsList}}" 
      wx:key="goods_id"
      bind:tap="onGoodsClick"
      data-goods-id="{{item.goods_id}}"
    >
      <!-- å•†å“å›¾ç‰‡ -->
      <view class="goods-image-wrapper">
        <image 
          wx:if="{{item.images && item.images.length > 0}}"
          class="goods-image" 
          src="{{item.images[0]}}" 
          mode="aspectFill"
          binderror="onImageError"
          data-index="{{index}}"
          lazy-load="{{true}}"
        />
        <image 
          wx:else
          class="goods-image" 
          src="/assets/store.png" 
          mode="aspectFill"
        />
        <view wx:if="{{item.group_buy_enabled}}" class="group-buy-badge">
          <text>æ‹¼å›¢</text>
        </view>
      </view>

      <!-- å•†å“ä¿¡æ¯ -->
      <view class="goods-info">
        <!-- å•†å“æè¿°ï¼ˆæœ€å¤šä¸¤è¡Œï¼‰ -->
        <view class="goods-description">{{item.description}}</view>
        
        <!-- ä»·æ ¼ -->
        <view class="goods-price">Â¥{{item.price}}</view>
        
        <!-- å‘å¸ƒè€…ä¿¡æ¯å’Œé”€é‡ -->
        <view class="goods-seller">
          <text class="seller-name">{{item.seller && (item.seller.nickname || item.seller.name) || 'æœªè®¾ç½®æ˜µç§°'}}</text>
          <text wx:if="{{item.sales_count !== undefined && item.sales_count !== null && item.sales_count > 0}}" class="sales-count">å·²å”®{{item.sales_count}}</text>
        </view>
      </view>
    </view>
  </view>

  <!-- åŠ è½½æ›´å¤šæç¤º -->
  <view wx:if="{{loading && goodsList.length > 0}}" class="loading-more">
    <text>åŠ è½½ä¸­...</text>
  </view>
  <view wx:if="{{!hasMore && goodsList.length > 0}}" class="no-more">
    <text>æ²¡æœ‰æ›´å¤šäº†</text>
  </view>
</view>




